name: ğŸ“¢ Sync Notify

on:
  workflow_run:
    workflows: ["ğŸ” Sync Changelog With PR"]
    types:
      - completed

jobs:
  on-success:
    runs-on: ubuntu-latest
    if: github.event.workflow_run.conclusion == 'success'
    steps:
      - name: Sync success after ding talk dev group notify
        uses: zcong1993/actions-ding@master
        with:
          dingToken: ${{ secrets.DING_TALK_ACCESS_TOKEN }}
          ignoreError: true
          body: |
            {
              "msgtype": "link",
              "link": {
                "title": "âœ… åŒæ­¥ changelog æˆåŠŸ",
                "text": "ğŸ“¢ è¯·å‘å¸ƒå€¼ç­åˆå¹¶è¯¥ PR å, è®¿é—®å®˜ç½‘æŸ¥çœ‹æ˜¯å¦æœ‰å¼‚å¸¸",
                "messageUrl": "https://s2.antv.antgroup.com",
                "picUrl": "https://gw.alipayobjects.com/zos/antfincdn/ISzgBCtgR/2c5c4aaa-4f40-46f7-8f6b-427fa9ff07bb.png"
              }
            }

  on-failure:
    runs-on: ubuntu-latest
    if: github.event.workflow_run.conclusion == 'failure'
    steps:
      - name: Sync failed after ding talk dev group notify
        uses: zcong1993/actions-ding@master
        with:
          dingToken: ${{ secrets.DING_TALK_ACCESS_TOKEN }}
          ignoreError: true
          body: |
            {
              "msgtype": "link",
              "link": {
                "title": "ğŸš¨ ğŸ” åŒæ­¥ Changelog å¤±è´¥",
                "text": "ğŸ”— è¯·ç‚¹å‡»é“¾æ¥æŸ¥çœ‹å…·ä½“åŸå› , ç‚¹å‡»å³ä¸Šè§’ [Re-run all jobs] æ‰‹åŠ¨åŒæ­¥ ğŸš‘",
                "messageUrl": "https://github.com/antvis/S2/actions/workflows/sync-site-lock-changelog-with-pr.yml",
                "picUrl": "https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*RXmkQrNYxqoAAAAAAAAAAAAADmJ7AQ/original"
              }
            }
